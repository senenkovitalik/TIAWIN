<!DOCTYPE html>
<html lang="en">
<head>
  <title>Переведення чисел</title>
  <meta charset="utf-8">
  <style>
    #center {
      margin: auto;
      width: 60%;
    }

    div {
      width: 400px;
      margin-bottom: 3px;
    }

    #dec, #precision {
      float: right;
      margin-left: 5px;
    }
    .clearfix {
      overflow: auto;
    }
  </style>
</head>
<body style="background-image: url('letter.jpg'); background-size: cover;">

<div id="center">
	<h1>Переведення числа з 10-ої системи числення в 2-ву</h1>
  <form>

    <div class="clearfix">
      <span>Введіть число яке треба перевести</span>
      <input id="dec" title="Будь-ласка, використовуйте тільки цифри і крапку" autofocus>
    </div>

    <div class="clearfix">
      <span>Кількість знаків після коми</span>
      <input id="precision" value="8" title="Кількість знаків після коми">
    </div>

    <input type="button" value="Перевести" onclick="decToBin()">
    
    <p id="bin"></p>

    <script>
      function decToBin() {

        // work with integers
        var mod, bin, decCopy = 0;
        var binary = [];
        var output = "";
        var i = 1;

        var dec = document.getElementById("dec").value;   // get numbers
        
        decCopy = dec;          // copy for fractional
        dec = Math.floor(dec)   // get integer path

        if (dec != 0) {
          do {                  // transformation
            mod = dec % 2;
            binary.push(mod);
            dec = Math.floor(dec/2);
          }
          while (dec >= 2);

          binary.push(1);       // append 1
          binary.reverse();     // reverse the array

          var i = 1;
          var offset = binary.length % 4;   // how much digit we need offset for pretty output
          var index = 0;

          for (index; index < binary.length; index++) {   // get output string
            if (offset == 0) {    // insert space after offset
              output += " ";  
              i = 0;  
            }
            offset--;

            if (i == 4) {         // insert space after each 4 digit
              output += " ";
              i = 0;
            }

            i++;
            output += binary[index];    // output string
          }
        } else output = "0";            // if number don't have integer

        

        // work with fractional numbers
        var drobChast = decCopy - Math.floor(decCopy);  // get the fractional path of number
        var drobArray = [];
        var out = "";
        var precision, i = 0;       // number of signs after comma

        precision = document.getElementById("precision").value - 1;

        if (drobChast != 0 && precision >= 0) {
          drobArray.push(0);                  // append 0
          for (i; i < precision; i++ ) {      // transformation
            drobChast *= 2;
            drobArray.push(Math.floor(drobChast));
            if (drobChast > 1) {
              drobChast -= 1;
            }
          }

          var index = 0;
          for (index; index < drobArray.length; index++) {  // get output string
            out += drobArray[index]; 
          }
          out = "," + out + "..."; 
        } else out = "";      // if fractional path = 0

        document.getElementById("bin").innerHTML = document.getElementById("dec").value + "<sub>(10)</sub> = " + output + out + "<sub>(2)</sub>"; 
      }
    </script>
  </form>
</div>

</body>
</html>